name: keycloak
version: 0.1.0
patches:
  common-env-features: |
    "ENABLE_THIRD_PARTY_AUTH": true
  lms-env: |
    "THIRD_PARTY_AUTH_BACKENDS": ["social_core.backends.keycloak.KeycloakOAuth2"]
  openedx-lms-common-settings: |
    SOCIAL_AUTH_KEYCLOAK_KEY: "openedx"
    SOCIAL_AUTH_KEYCLOAK_SECRET: "Zm19jiV9AqeMCHDfvwRlPDEF9eEeCHxz"
    SOCIAL_AUTH_KEYCLOAK_AUTHORIZATION_URL: "https://keycloak.a2o.ucoip.pt/realms/a2o/protocol/openid-connect/auth"
    SOCIAL_AUTH_KEYCLOAK_ACCESS_TOKEN_URL: "https://keycloak.a2o.ucoip.pt/realms/a2o/protocol/openid-connect/token"
    SOCIAL_AUTH_KEYCLOAK_USERINFO_URL: "https://keycloak.a2o.ucoip.pt/realms/a2o/protocol/openid-connect/userinfo"
    SOCIAL_AUTH_KEYCLOAK_ID_KEY: "email"
    SOCIAL_AUTH_KEYCLOAK_OIDC_VERIFY_SSL: true
    SOCIAL_AUTH_OAUTH_SECRETS: { "keycloak": "Zm19jiV9AqeMCHDfvwRlPDEF9eEeCHxz" }
    # Adicione esta linha com o valor correto do aud (ex.: "account" ou outro encontrado no token)
    SOCIAL_AUTH_KEYCLOAK_AUTH_EXTRA_ARGUMENTS: '{"audience": "openedx"}'
